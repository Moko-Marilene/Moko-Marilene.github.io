<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="ABOULA Grivo">
<meta name="author" content="DEBA Franck">
<meta name="author" content="KOUGOUM Marilene">

<title>Gestion de risques multiples : implémentations –</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap-e31584831b205ffbb2d98406f31c2a5b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../logo.png" alt="" class="navbar-logo light-content">
    <img src="../../../logo.png" alt="" class="navbar-logo dark-content">
    </a>
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title"></span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../index.html"> 
<span class="menu-text">Accueil</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../finance.html"> 
<span class="menu-text">Finance Quantitative</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../risques/index.html"> 
<span class="menu-text">Risque &amp; Régulation</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../modelisation-stat.qmd"> 
<span class="menu-text">Modélisation stat</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../data-science.html"> 
<span class="menu-text">Data science</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../articles-ressources.qmd"> 
<span class="menu-text">Ressources</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html"> 
<span class="menu-text">À propos</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#extraire-les-probabilités-de-défaut-implicites" id="toc-extraire-les-probabilités-de-défaut-implicites" class="nav-link active" data-scroll-target="#extraire-les-probabilités-de-défaut-implicites">1. Extraire les probabilités de défaut implicites</a></li>
  <li><a href="#caractériser-les-distributions-des-taux-de-recouvrement-de-chacune-des-deux-créances" id="toc-caractériser-les-distributions-des-taux-de-recouvrement-de-chacune-des-deux-créances" class="nav-link" data-scroll-target="#caractériser-les-distributions-des-taux-de-recouvrement-de-chacune-des-deux-créances">2. Caractériser les distributions des taux de recouvrement de chacune des deux créances</a>
  <ul class="collapse">
  <li><a href="#interpétation" id="toc-interpétation" class="nav-link" data-scroll-target="#interpétation">Interpétation :</a></li>
  <li><a href="#on-affiche-les-courbes-de-densité-des-taux-de-recouvrement-de-bnp-et-de-sg" id="toc-on-affiche-les-courbes-de-densité-des-taux-de-recouvrement-de-bnp-et-de-sg" class="nav-link" data-scroll-target="#on-affiche-les-courbes-de-densité-des-taux-de-recouvrement-de-bnp-et-de-sg">On affiche les courbes de densité des taux de recouvrement de BNP et de SG</a></li>
  </ul></li>
  <li><a href="#on-sintéresse-à-lhistorique-des-données-actions." id="toc-on-sintéresse-à-lhistorique-des-données-actions." class="nav-link" data-scroll-target="#on-sintéresse-à-lhistorique-des-données-actions.">3. On s’intéresse à l’historique des données actions.</a>
  <ul class="collapse">
  <li><a href="#a.-effectuer-une-analyse-exploratoire-univariée-des-données-actions-de-ces-deux-entreprises" id="toc-a.-effectuer-une-analyse-exploratoire-univariée-des-données-actions-de-ces-deux-entreprises" class="nav-link" data-scroll-target="#a.-effectuer-une-analyse-exploratoire-univariée-des-données-actions-de-ces-deux-entreprises">3.a. Effectuer une analyse exploratoire univariée des données actions de ces deux entreprises</a>
  <ul class="collapse">
  <li><a href="#statistiques-descriptives-des-rendements-et-des-log-rendements." id="toc-statistiques-descriptives-des-rendements-et-des-log-rendements." class="nav-link" data-scroll-target="#statistiques-descriptives-des-rendements-et-des-log-rendements.">Statistiques descriptives des rendements et des log rendements.</a></li>
  <li><a href="#evolution-du-cours-des-actions-de-bnp-et-sg-ainsi-que-celle-de-leurs-log-rendements" id="toc-evolution-du-cours-des-actions-de-bnp-et-sg-ainsi-que-celle-de-leurs-log-rendements" class="nav-link" data-scroll-target="#evolution-du-cours-des-actions-de-bnp-et-sg-ainsi-que-celle-de-leurs-log-rendements">Evolution du cours des actions de BNP et SG ainsi que celle de leurs log rendements</a></li>
  </ul></li>
  <li><a href="#b-modéliser-judicieusement-les-distributions-univariées-des-facteurs-de-risques" id="toc-b-modéliser-judicieusement-les-distributions-univariées-des-facteurs-de-risques" class="nav-link" data-scroll-target="#b-modéliser-judicieusement-les-distributions-univariées-des-facteurs-de-risques">3.b Modéliser judicieusement les distributions univariées des facteurs de risques</a>
  <ul class="collapse">
  <li><a href="#modélisation-des-lois-marginales-associées-aux-log-rendements" id="toc-modélisation-des-lois-marginales-associées-aux-log-rendements" class="nav-link" data-scroll-target="#modélisation-des-lois-marginales-associées-aux-log-rendements">Modélisation des lois marginales associées aux log rendements</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#étudier-la-structure-de-dépendance-entre-les-facteurs-de-risques-sur-la-base-de-critères-non-paramétriques." id="toc-étudier-la-structure-de-dépendance-entre-les-facteurs-de-risques-sur-la-base-de-critères-non-paramétriques." class="nav-link" data-scroll-target="#étudier-la-structure-de-dépendance-entre-les-facteurs-de-risques-sur-la-base-de-critères-non-paramétriques.">4. Étudier la structure de dépendance entre les facteurs de risques sur la base de critères non paramétriques.</a>
  <ul class="collapse">
  <li><a href="#coefficient-de-spearmann-et-taux-de-kendall" id="toc-coefficient-de-spearmann-et-taux-de-kendall" class="nav-link" data-scroll-target="#coefficient-de-spearmann-et-taux-de-kendall">Coefficient de Spearmann et taux de Kendall</a></li>
  <li><a href="#dépendogramme" id="toc-dépendogramme" class="nav-link" data-scroll-target="#dépendogramme">Dépendogramme</a></li>
  </ul></li>
  <li><a href="#modéliser-la-structure-de-dépendance-au-moyen-des-copules-paramétriques-suivantes" id="toc-modéliser-la-structure-de-dépendance-au-moyen-des-copules-paramétriques-suivantes" class="nav-link" data-scroll-target="#modéliser-la-structure-de-dépendance-au-moyen-des-copules-paramétriques-suivantes">5. Modéliser la structure de dépendance au moyen des copules paramétriques suivantes :</a>
  <ul class="collapse">
  <li><a href="#a.-copules-elliptiques-gaussienne-student." id="toc-a.-copules-elliptiques-gaussienne-student." class="nav-link" data-scroll-target="#a.-copules-elliptiques-gaussienne-student.">5.a. Copules elliptiques : gaussienne, Student.</a></li>
  </ul></li>
  <li><a href="#modéliser-la-structure-de-dépendance-au-moyen-des-copules-paramétriques-suivantes-1" id="toc-modéliser-la-structure-de-dépendance-au-moyen-des-copules-paramétriques-suivantes-1" class="nav-link" data-scroll-target="#modéliser-la-structure-de-dépendance-au-moyen-des-copules-paramétriques-suivantes-1">5. Modéliser la structure de dépendance au moyen des copules paramétriques suivantes :</a>
  <ul class="collapse">
  <li><a href="#copules-elliptiques-gaussienne-student." id="toc-copules-elliptiques-gaussienne-student." class="nav-link" data-scroll-target="#copules-elliptiques-gaussienne-student.">Copules elliptiques : gaussienne, Student.</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Gestion de risques multiples : implémentations</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
             <p>ABOULA Grivo </p>
             <p>DEBA Franck </p>
             <p>KOUGOUM Marilene </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<p><a href="../index.qmd">⬅ Retour</a></p>
<section id="extraire-les-probabilités-de-défaut-implicites" class="level1">
<h1>1. Extraire les probabilités de défaut implicites</h1>
<div id="0719b573" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.stats <span class="im">as</span> stats</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> binom, norm, skew, kurtosis, t, beta</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.optimize <span class="im">import</span> minimize</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="9de52a32" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> pd_from_cds(spread_bp, maturity, recovery<span class="op">=</span><span class="fl">0.40</span>):</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">""" </span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Fonction pour extraire les probabilité de défaut implicite</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Conversion bp -&gt; décimal (1bp = 0.0001)</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    spread <span class="op">=</span> spread_bp <span class="op">/</span> <span class="dv">10000</span>  </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    lambda_ <span class="op">=</span> spread <span class="op">/</span> (<span class="dv">1</span> <span class="op">-</span> recovery)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    pd <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> np.exp(<span class="op">-</span>lambda_ <span class="op">*</span> maturity)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="8f784d8b" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour BNP</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>pd_bnp_4y <span class="op">=</span> pd_from_cds(<span class="dv">100</span>, <span class="dv">4</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>pd_bnp_5y <span class="op">=</span> pd_from_cds(<span class="dv">120</span>, <span class="dv">5</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour SG</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>pd_sg_4y <span class="op">=</span> pd_from_cds(<span class="dv">120</span>, <span class="dv">4</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>pd_sg_5y <span class="op">=</span> pd_from_cds(<span class="dv">150</span>, <span class="dv">5</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"PD BNP 4 ans :"</span>, pd_bnp_4y)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"PD BNP 5 ans :"</span>, pd_bnp_5y)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"PD SG 4 ans :"</span>, pd_sg_4y)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"PD SG 5 ans :"</span>, pd_sg_5y)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>PD BNP 4 ans : 0.06449301496838222
PD BNP 5 ans : 0.09516258196404048
PD SG 4 ans : 0.07688365361336424
PD SG 5 ans : 0.11750309741540454</code></pre>
</div>
</div>
</section>
<section id="caractériser-les-distributions-des-taux-de-recouvrement-de-chacune-des-deux-créances" class="level1">
<h1>2. Caractériser les distributions des taux de recouvrement de chacune des deux créances</h1>
<hr>
<div id="b825d02e" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour carctériser les distributions des taux de recouvrement, on suppose que les recouvrement </span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># suivent une loi Beta</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># On déduit les paramètres à partir de la moyenne et de la volatilité</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> beta_params(mean, vol):</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""  </span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Fonction qui retourne les paramètres de la loi Beta à partir de la moyenne et de la volatilité</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    a_chapeau <span class="op">=</span> (mean<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> mean))<span class="op">/</span>(vol<span class="op">**</span><span class="dv">2</span>) <span class="op">-</span> mean</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    b_chapeau <span class="op">=</span> (mean<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> mean)<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span>(mean <span class="op">*</span> vol<span class="op">**</span><span class="dv">2</span>) <span class="op">-</span> (<span class="dv">1</span><span class="op">-</span> mean)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> a_chapeau, b_chapeau</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="cdcbeb99" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour BNP (moyenne 60 %, vol 15 %)</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>mean_bnp <span class="op">=</span> <span class="fl">0.60</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>vol_bnp <span class="op">=</span> <span class="fl">0.15</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>a_chapeau_bnp, b_chapeau_bnp <span class="op">=</span> beta_params(mean_bnp, vol_bnp)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour SG (moyenne 30 %, vol 25 %)</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>mean_sg <span class="op">=</span> <span class="fl">0.30</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>vol_sg <span class="op">=</span> <span class="fl">0.25</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>a_chapeau_sg, b_chapeau_sg<span class="op">=</span> beta_params(mean_sg, vol_sg)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"BNP Beta parameters: alpha ="</span>, a_chapeau_bnp, <span class="st">"beta ="</span>, b_chapeau_bnp)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"SG Beta parameters: alpha ="</span>, a_chapeau_sg, <span class="st">"beta ="</span>, b_chapeau_sg)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>BNP Beta parameters: alpha = 5.8 beta = 3.8666666666666676
SG Beta parameters: alpha = 0.708 beta = 1.652</code></pre>
</div>
</div>
<section id="interpétation" class="level3">
<h3 class="anchored" data-anchor-id="interpétation">Interpétation :</h3>
<ul>
<li><h4 id="pour-bnp-a-b-on-a-donc-une-asymétrie-à-droite-des-taux-de-recouvrement" class="anchored">Pour BNP : a &gt; b on a donc une asymétrie à droite des taux de recouvrement</h4></li>
<li><h4 id="pur-sg-a-b" class="anchored">Pur SG : a &lt; b</h4></li>
</ul>
<hr>
</section>
<section id="on-affiche-les-courbes-de-densité-des-taux-de-recouvrement-de-bnp-et-de-sg" class="level3">
<h3 class="anchored" data-anchor-id="on-affiche-les-courbes-de-densité-des-taux-de-recouvrement-de-bnp-et-de-sg">On affiche les courbes de densité des taux de recouvrement de BNP et de SG</h3>
<div id="d098b973" class="cell" data-execution_count="6">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> beta</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_beta_distribution(a_chapeau, b_chapeau):</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Affiche un graphique de la distribution Beta avec les paramètres donnés.</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co">    Paramètres :</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co">    a_chapeau : float : paramètre alpha de la distribution Beta</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co">    b_chapeau : float : paramètre beta de la distribution Beta</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> np.linspace(beta.ppf(<span class="fl">0.01</span>, a_chapeau, b_chapeau),</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>                    beta.ppf(<span class="fl">0.99</span>, a_chapeau, b_chapeau), <span class="dv">100</span>)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> beta.pdf(x, a_chapeau, b_chapeau)</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>    ax.plot(x, y, <span class="st">'r-'</span>, lw<span class="op">=</span><span class="dv">3</span>, alpha<span class="op">=</span><span class="fl">0.8</span>, label<span class="op">=</span><span class="st">'PDF Beta'</span>)</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="st">'Distribution Beta'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">'Valeurs'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">'Densité de probabilité'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>    ax.tick_params(axis<span class="op">=</span><span class="st">'both'</span>, which<span class="op">=</span><span class="st">'major'</span>, labelsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>    ax.grid(<span class="va">True</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>    ax.legend(loc<span class="op">=</span><span class="st">'best'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>plot_beta_distribution(a_chapeau_bnp, b_chapeau_bnp)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Codes_copules_files/figure-html/cell-7-output-1.png" width="674" height="536" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="457d6f42" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>plot_beta_distribution(a_chapeau_sg, b_chapeau_sg)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Codes_copules_files/figure-html/cell-8-output-1.png" width="658" height="536" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="b42d599f" class="cell" data-execution_count="8">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_beta_distribution(a_chapeau_bnp, b_chapeau_bnp, a_chapeau_sg, b_chapeau_sg):</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Affiche un graphique de la distribution Beta avec les paramètres donnés.</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Affiche les deux distributions Beta sur le même graphique et colorie les surfaces différemment.</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Paramètres :</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">    a_chapeau_bnp : float : paramètre alpha de la distribution Beta pour BNP</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">    b_chapeau_bnp : float : paramètre beta de la distribution Beta pour BNP</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">    a_chapeau_sg : float : paramètre alpha de la distribution Beta pour SG</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">    b_chapeau_sg : float : paramètre beta de la distribution Beta spour SG</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1000</span>)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculons des densités de probabilité pour BNP et SG</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    y_bnp <span class="op">=</span> beta.pdf(x, a_chapeau_bnp, b_chapeau_bnp)</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    y_sg <span class="op">=</span> beta.pdf(x, a_chapeau_sg, b_chapeau_sg)</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Tracons la densité de probabilité Beta pour BNP (en rouge)</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>    ax.plot(x, y_bnp, <span class="st">'r-'</span>, lw<span class="op">=</span><span class="dv">3</span>, alpha<span class="op">=</span><span class="fl">0.8</span>, label<span class="op">=</span><span class="st">'Courbe de densité BNP'</span>)</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>    ax.fill_between(x, y_bnp, color<span class="op">=</span><span class="st">'red'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Tracons la densité de probabilité Beta pour SG (en bleu)</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>    ax.plot(x, y_sg, <span class="st">'b-'</span>, lw<span class="op">=</span><span class="dv">3</span>, alpha<span class="op">=</span><span class="fl">0.8</span>, label<span class="op">=</span><span class="st">'Courbe de densité SG'</span>)</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>    ax.fill_between(x, y_sg, color<span class="op">=</span><span class="st">'blue'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="st">'Comparaison des Distributions Beta'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">'Valeurs'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">'Densité de probabilité'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>    ax.tick_params(axis<span class="op">=</span><span class="st">'both'</span>, which<span class="op">=</span><span class="st">'major'</span>, labelsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>    ax.grid(<span class="va">True</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>    ax.legend(loc<span class="op">=</span><span class="st">'best'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>plot_beta_distribution(a_chapeau_bnp, b_chapeau_bnp, a_chapeau_sg, b_chapeau_sg)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Codes_copules_files/figure-html/cell-9-output-1.png" width="658" height="536" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>la courbe de la BNP est davantage décalée vers la droite, sa distribution est davantage concentrée vers la droite comparativement à celle de SG. Ceci suggère ainsi une meilleure performance de BNP en termes de recouvrement.</p>
</section>
</section>
<section id="on-sintéresse-à-lhistorique-des-données-actions." class="level1">
<h1>3. On s’intéresse à l’historique des données actions.</h1>
<hr>
<section id="a.-effectuer-une-analyse-exploratoire-univariée-des-données-actions-de-ces-deux-entreprises" class="level2">
<h2 class="anchored" data-anchor-id="a.-effectuer-une-analyse-exploratoire-univariée-des-données-actions-de-ces-deux-entreprises">3.a. Effectuer une analyse exploratoire univariée des données actions de ces deux entreprises</h2>
<p>On s’intéresse ici à l’historique des prix bruts des actions mais également à celui des log rendements car ils representent une mesure normalisée qui permet de mieux apprecier la volatilité des prix.</p>
<p>Les log rendements étant définis comme suit :</p>
<p>$$</p>
<p> = ()</p>
<p>$$</p>
<p>Où :</p>
<ul>
<li><p>$ _t $ est le prix de l’action à l’instant t,</p></li>
<li><p>$ _{t-1} $ est le prix de l’action à l’instant t-1.</p></li>
</ul>
<div id="4dd8a495" class="cell" data-execution_count="9">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Chargement des données</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_csv(<span class="st">"data.txt"</span>, sep<span class="op">=</span><span class="st">"</span><span class="er">\</span><span class="st">s+"</span>, header<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>data.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>&lt;&gt;:2: SyntaxWarning: "\s" is an invalid escape sequence. Such sequences will not work in the future. Did you mean "\\s"? A raw string is also an option.
&lt;&gt;:2: SyntaxWarning: "\s" is an invalid escape sequence. Such sequences will not work in the future. Did you mean "\\s"? A raw string is also an option.
C:\Users\mokom\AppData\Local\Temp\ipykernel_18364\1367165320.py:2: SyntaxWarning: "\s" is an invalid escape sequence. Such sequences will not work in the future. Did you mean "\\s"? A raw string is also an option.
  data = pd.read_csv("data.txt", sep="\s+", header=0)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">BNP</th>
<th data-quarto-table-cell-role="th">SG</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>42.36</td>
<td>55.24</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>42.72</td>
<td>55.59</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>43.20</td>
<td>56.45</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>42.67</td>
<td>55.55</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>41.81</td>
<td>54.50</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<section id="statistiques-descriptives-des-rendements-et-des-log-rendements." class="level3">
<h3 class="anchored" data-anchor-id="statistiques-descriptives-des-rendements-et-des-log-rendements.">Statistiques descriptives des rendements et des log rendements.</h3>
<div id="f496ef6c" class="cell" data-execution_count="10">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">## principales caractéristiques de tendances centrales et de dispersion  des prix des actions</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>data.describe()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">BNP</th>
<th data-quarto-table-cell-role="th">SG</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">count</th>
<td>1000.000000</td>
<td>1000.000000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">mean</th>
<td>31.906254</td>
<td>43.532641</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">std</th>
<td>9.630129</td>
<td>10.007847</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">min</th>
<td>14.056200</td>
<td>21.667700</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">25%</th>
<td>23.450325</td>
<td>36.065350</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">50%</th>
<td>34.353700</td>
<td>46.824800</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">75%</th>
<td>40.229375</td>
<td>51.291675</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">max</th>
<td>48.330000</td>
<td>60.680000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="4aacd0e5" class="cell" data-execution_count="11">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Calcul des log rendements</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="53847d53" class="cell" data-execution_count="12">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>data_returns <span class="op">=</span> np.log(data<span class="op">/</span>data.shift(<span class="dv">1</span>)).dropna()</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>data_returns.head(<span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">BNP</th>
<th data-quarto-table-cell-role="th">SG</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">1</th>
<td>0.008463</td>
<td>0.006316</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2</th>
<td>0.011173</td>
<td>0.015352</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">3</th>
<td>-0.012344</td>
<td>-0.016072</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="2b239d3d" class="cell" data-execution_count="13">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">## principales caractéristiques de tendances centrales et de dispersion log rendements des actions</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>data_returns.describe()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">BNP</th>
<th data-quarto-table-cell-role="th">SG</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">count</th>
<td>999.000000</td>
<td>999.000000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">mean</th>
<td>-0.000888</td>
<td>-0.000687</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">std</th>
<td>0.024441</td>
<td>0.020731</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">min</th>
<td>-0.123524</td>
<td>-0.098292</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">25%</th>
<td>-0.013867</td>
<td>-0.011830</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">50%</th>
<td>-0.000358</td>
<td>-0.000547</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">75%</th>
<td>0.012526</td>
<td>0.011223</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">max</th>
<td>0.083225</td>
<td>0.076478</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Nous procédons ci après à des statistiques descriptives plus exhausives. Incluant notamment des test de stationnarité, l’évaluation de l’asymétrie et des niveaux d’aplatissement de nos distributions</p>
<div id="aea0106d" class="cell" data-execution_count="14">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> shapiro</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.tsa.stattools <span class="im">import</span> adfuller</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> analyze_data(df, name<span class="op">=</span><span class="st">"Dataset"</span>):</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Analyse les données du DataFrame fourni et retourne un DataFrame avec :</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co">    - Statistiques descriptives</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co">    - Tests de stationnarité (Dickey-Fuller)</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Paramètres :</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="co">    df : DataFrame : Doit contenir les colonnes 'Close' et 'Rendement'</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co">    name : str : Nom du dataset (optionnel)</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co">    Retourne :</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="co">    results : DataFrame avec toutes les analyses</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Vérification de la présence des colonnes nécessaires</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> {<span class="st">'Close'</span>, <span class="st">'Rendement'</span>}.issubset(df.columns):</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">"Le DataFrame doit contenir les colonnes 'Close' et 'Rendement'."</span>)</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Statistiques descriptives</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> df[[<span class="st">'Close'</span>, <span class="st">'Rendement'</span>]].describe()</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>    results[<span class="st">'Indicateur'</span>] <span class="op">=</span> [<span class="st">"Nombre"</span>, <span class="st">"Moyenne"</span>, <span class="st">"Ecart-Type"</span>, <span class="st">"Minimum"</span>, <span class="st">"Percentile 25%"</span>, <span class="st">"Médiane"</span>, <span class="st">"Percentile 75%"</span>, <span class="st">"Maximum"</span>]</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> results[[<span class="st">'Indicateur'</span>, <span class="st">'Close'</span>, <span class="st">'Rendement'</span>]]</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Test de stationnarité (Dickey-Fuller)</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>    _, p_value_rend <span class="op">=</span> adfuller(df[<span class="st">'Rendement'</span>].dropna())[:<span class="dv">2</span>]</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>    _, p_value_close <span class="op">=</span> adfuller(df[<span class="st">'Close'</span>].dropna())[:<span class="dv">2</span>]</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Kurtosis </span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>    kurtosis_rend <span class="op">=</span> df[<span class="st">'Rendement'</span>].dropna().kurt()</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>    kurtosis_close <span class="op">=</span> df[<span class="st">'Close'</span>].dropna().kurt()</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># skewness</span></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>    skew_rend <span class="op">=</span> df[<span class="st">'Rendement'</span>].dropna().skew()</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>    skew_close <span class="op">=</span> df[<span class="st">'Close'</span>].dropna().skew()</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> pd.concat([results, pd.DataFrame([[<span class="st">"Stationnarité (p)"</span>, p_value_close, p_value_rend ]], columns<span class="op">=</span>results.columns)])</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> pd.concat([results, pd.DataFrame([[<span class="st">"Asymétrie"</span>, skew_close , skew_rend ]], columns<span class="op">=</span>results.columns)])</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> pd.concat([results, pd.DataFrame([[<span class="st">"Excess Kurtosis"</span>, kurtosis_close, kurtosis_rend ]], columns<span class="op">=</span>results.columns)])</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> results</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>data_bnp <span class="op">=</span> pd.concat([data[<span class="st">"BNP"</span>], data_returns[<span class="st">"BNP"</span>]], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>data_bnp.columns <span class="op">=</span> [<span class="st">'Close'</span>, <span class="st">'Rendement'</span>]  <span class="co"># Renommage des colonnes</span></span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>analyze_data(data_bnp)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Indicateur</th>
<th data-quarto-table-cell-role="th">Close</th>
<th data-quarto-table-cell-role="th">Rendement</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">count</th>
<td>Nombre</td>
<td>1000.000000</td>
<td>999.000000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">mean</th>
<td>Moyenne</td>
<td>31.906254</td>
<td>-0.000888</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">std</th>
<td>Ecart-Type</td>
<td>9.630129</td>
<td>0.024441</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">min</th>
<td>Minimum</td>
<td>14.056200</td>
<td>-0.123524</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">25%</th>
<td>Percentile 25%</td>
<td>23.450325</td>
<td>-0.013867</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">50%</th>
<td>Médiane</td>
<td>34.353700</td>
<td>-0.000358</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">75%</th>
<td>Percentile 75%</td>
<td>40.229375</td>
<td>0.012526</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">max</th>
<td>Maximum</td>
<td>48.330000</td>
<td>0.083225</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>Stationnarité (p)</td>
<td>0.794391</td>
<td>0.000000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">0</th>
<td>Asymétrie</td>
<td>-0.310893</td>
<td>-0.331426</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>Excess Kurtosis</td>
<td>-1.233209</td>
<td>2.016973</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="c8f73170" class="cell" data-execution_count="15">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>data_sg <span class="op">=</span> pd.concat([data[<span class="st">"SG"</span>], data_returns[<span class="st">"SG"</span>]], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>data_sg.columns <span class="op">=</span> [<span class="st">'Close'</span>, <span class="st">'Rendement'</span>]  <span class="co"># Renommage des colonnes</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>analyze_data(data_sg)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="15">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Indicateur</th>
<th data-quarto-table-cell-role="th">Close</th>
<th data-quarto-table-cell-role="th">Rendement</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">count</th>
<td>Nombre</td>
<td>1000.000000</td>
<td>9.990000e+02</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">mean</th>
<td>Moyenne</td>
<td>43.532641</td>
<td>-6.874575e-04</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">std</th>
<td>Ecart-Type</td>
<td>10.007847</td>
<td>2.073120e-02</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">min</th>
<td>Minimum</td>
<td>21.667700</td>
<td>-9.829201e-02</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">25%</th>
<td>Percentile 25%</td>
<td>36.065350</td>
<td>-1.182979e-02</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">50%</th>
<td>Médiane</td>
<td>46.824800</td>
<td>-5.468895e-04</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">75%</th>
<td>Percentile 75%</td>
<td>51.291675</td>
<td>1.122288e-02</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">max</th>
<td>Maximum</td>
<td>60.680000</td>
<td>7.647830e-02</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>Stationnarité (p)</td>
<td>0.736159</td>
<td>8.678531e-09</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">0</th>
<td>Asymétrie</td>
<td>-0.489312</td>
<td>-1.797332e-01</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>Excess Kurtosis</td>
<td>-0.933549</td>
<td>2.097393e+00</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<section id="commentaire" class="level4">
<h4 class="anchored" data-anchor-id="commentaire">Commentaire :</h4>
<p>Les cours des actions de BNP et de société générale sont tous deux assez variables sur la période d’étude. Les log rendements associés sont très volatiles, avec une dispersion allant jusqu’à l’ordre de 30 fois supérieur à la valeur absolue de la moyenne</p>
</section>
</section>
<section id="evolution-du-cours-des-actions-de-bnp-et-sg-ainsi-que-celle-de-leurs-log-rendements" class="level3">
<h3 class="anchored" data-anchor-id="evolution-du-cours-des-actions-de-bnp-et-sg-ainsi-que-celle-de-leurs-log-rendements">Evolution du cours des actions de BNP et SG ainsi que celle de leurs log rendements</h3>
<p>Cette evolution permet d’illustrer de maniere visuelle la forte volatilité des rendements des actions de BNP et de SG</p>
<div id="d6dd474e" class="cell" data-execution_count="16">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>ax.plot(data[<span class="st">"BNP"</span>], <span class="st">'r-'</span>, lw<span class="op">=</span><span class="dv">1</span>, alpha<span class="op">=</span><span class="fl">0.8</span>, label<span class="op">=</span><span class="st">'BNP'</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>ax.plot(data[<span class="st">"SG"</span>], <span class="st">'b-'</span>, lw<span class="op">=</span><span class="dv">1</span>, alpha<span class="op">=</span><span class="fl">0.8</span>, label<span class="op">=</span><span class="st">'SG'</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">"Évolution du cours de l'action de BNP et SG"</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Temps'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"Cours de l'action"</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>ax.tick_params(axis<span class="op">=</span><span class="st">'both'</span>, which<span class="op">=</span><span class="st">'major'</span>, labelsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>ax.legend(loc<span class="op">=</span><span class="st">'best'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Codes_copules_files/figure-html/cell-17-output-1.png" width="668" height="536" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="3f4ade26" class="cell" data-execution_count="17">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>fig, (ax1, ax2) <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">8</span>))</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Graphique pour BNP</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>ax1.plot(data_returns[<span class="st">"BNP"</span>], <span class="st">'r-'</span>, lw<span class="op">=</span><span class="dv">1</span>, alpha<span class="op">=</span><span class="fl">0.8</span>, label<span class="op">=</span><span class="st">'BNP'</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">"Évolution du cours des rendements de l'action BNP"</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'Temps'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">"Rendements des actions"</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>ax1.tick_params(axis<span class="op">=</span><span class="st">'both'</span>, which<span class="op">=</span><span class="st">'major'</span>, labelsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>ax1.grid(<span class="va">True</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>ax1.legend(loc<span class="op">=</span><span class="st">'best'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Graphique pour SG</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>ax2.plot(data_returns[<span class="st">"SG"</span>], <span class="st">'b-'</span>, lw<span class="op">=</span><span class="dv">1</span>, alpha<span class="op">=</span><span class="fl">0.8</span>, label<span class="op">=</span><span class="st">'SG'</span>)</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">"Évolution du cours des rendements de l'action SG"</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'Temps'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">"Rendements des actions"</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>ax2.tick_params(axis<span class="op">=</span><span class="st">'both'</span>, which<span class="op">=</span><span class="st">'major'</span>, labelsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>ax2.grid(<span class="va">True</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>ax2.legend(loc<span class="op">=</span><span class="st">'best'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Codes_copules_files/figure-html/cell-18-output-1.png" width="758" height="759" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="b-modéliser-judicieusement-les-distributions-univariées-des-facteurs-de-risques" class="level2">
<h2 class="anchored" data-anchor-id="b-modéliser-judicieusement-les-distributions-univariées-des-facteurs-de-risques">3.b Modéliser judicieusement les distributions univariées des facteurs de risques</h2>
<section id="histogrammes-et-courbes-de-densité-des-log-rendements-des-actions-de-bnp-et-sg" class="level4">
<h4 class="anchored" data-anchor-id="histogrammes-et-courbes-de-densité-des-log-rendements-des-actions-de-bnp-et-sg">Histogrammes et courbes de densité des log rendements des actions de BNP et SG</h4>
<div id="dc514fc7" class="cell" data-execution_count="18">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> HistogPlot(data, label):</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    sns.kdeplot(data, color <span class="op">=</span> <span class="st">"r"</span>, lw<span class="op">=</span><span class="dv">2</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, label<span class="op">=</span>label)  <span class="co"># Density</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    n, bins, patches <span class="op">=</span> plt.hist(</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>        data, bins<span class="op">=</span><span class="dv">20</span>, density<span class="op">=</span><span class="va">True</span>, histtype<span class="op">=</span><span class="st">"stepfilled"</span>, alpha<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    )  <span class="co"># Histogram</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    ymax <span class="op">=</span> plt.ylim()[<span class="dv">1</span>]  <span class="co"># Get the max y value for positioning text</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ajout de la moyenne</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    plt.axvline(x<span class="op">=</span>np.mean(data))</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    plt.text(np.mean(data), ymax <span class="op">*</span> <span class="fl">0.5</span>, <span class="st">"Moyenne"</span>, rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ajout de la médiane</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>    plt.axvline(x<span class="op">=</span>np.median(data))</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    plt.text(np.median(data), ymax <span class="op">*</span> <span class="fl">0.7</span>, <span class="st">"Médiane"</span>, rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Adjout du mode</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>    plt.axvline(x<span class="op">=</span>(bins[n.argmax()] <span class="op">+</span> bins[n.argmax() <span class="op">+</span> <span class="dv">1</span>]) <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>    plt.text((bins[n.argmax()] <span class="op">+</span> bins[n.argmax() <span class="op">+</span> <span class="dv">1</span>]) <span class="op">/</span> <span class="dv">2</span>, ymax <span class="op">*</span> <span class="fl">0.2</span>, <span class="st">"Mode"</span>, rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>    plt.legend()</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">18</span>, <span class="dv">5</span>))</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> plt.subplot(<span class="dv">131</span>)</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>HistogPlot(data_returns[<span class="st">"BNP"</span>], <span class="st">"Densité des rendements d'actions BNP"</span>)</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> plt.subplot(<span class="dv">132</span>)</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>HistogPlot(data_returns[<span class="st">"SG"</span>], <span class="st">"Densité des rendements d'action SG"</span>)</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Codes_copules_files/figure-html/cell-19-output-1.png" width="941" height="429" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Dans les deux cas on observe des courbes en forme de cloche, et sensiblement symétrique, ce qui laisse présager une loi normale. Mais les kurtosis excessifs sont supérieurs à 2 et donc des kurtosis supérieurs à 5. Nous allons donc modéliser en plus des lois gaussiennes des lois à queues lourdes, notamment une Student et une Skew Student.</p>
</section>
<section id="modélisation-des-lois-marginales-associées-aux-log-rendements" class="level3">
<h3 class="anchored" data-anchor-id="modélisation-des-lois-marginales-associées-aux-log-rendements">Modélisation des lois marginales associées aux log rendements</h3>
<div id="48c88050" class="cell" data-execution_count="19">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.stats <span class="im">as</span> stats</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> norm, t, kstest, skew</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> skew_student <span class="im">import</span><span class="op">*</span>  <span class="co"># Import de la Skew-Student</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> modeliser_distribution(data):</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Modélise une distribution normale, Student et Skew-Student, compare les ajustements et sélectionne la meilleure.</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="co">    Paramètre :</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="co">    - data : array NumPy contenant l'échantillon de données.</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="co">    Retour :</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="co">    - Un dictionnaire contenant la distribution sélectionnée et les p-values du KS test.</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">#  1. Estimation des paramètres</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>    mu_norm, sigma_norm <span class="op">=</span> norm.fit(data)  <span class="co"># Loi normale</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>    df_t, loc_t, scale_t <span class="op">=</span> t.fit(data)  <span class="co"># Loi de Student</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>    mu_skew, sigma_skew, gamma_skew, nu_skew <span class="op">=</span> optimize_parameters(data)  <span class="co"># Loi Skew-Student</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"--"</span><span class="op">*</span><span class="dv">10</span>,<span class="st">"PARAMETRES ESTIMES"</span>, <span class="st">"--"</span><span class="op">*</span><span class="dv">10</span>)</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Loi Normale - Moyenne: </span><span class="sc">{</span>mu_norm<span class="sc">:.3f}</span><span class="ss">, Écart-type: </span><span class="sc">{</span>sigma_norm<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Loi de Student - df: </span><span class="sc">{</span>df_t<span class="sc">:.3f}</span><span class="ss">, Moyenne: </span><span class="sc">{</span>loc_t<span class="sc">:.3f}</span><span class="ss">, Échelle: </span><span class="sc">{</span>scale_t<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Loi Skew-Student - μ: </span><span class="sc">{</span>mu_skew<span class="sc">:.3f}</span><span class="ss">, σ: </span><span class="sc">{</span>sigma_skew<span class="sc">:.3f}</span><span class="ss">, γ: </span><span class="sc">{</span>gamma_skew<span class="sc">:.3f}</span><span class="ss">, ν: </span><span class="sc">{</span>nu_skew<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"--"</span><span class="op">*</span><span class="dv">30</span>)</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>    <span class="co">#  2. Affichage des Q-Q Plots juxtaposés</span></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>    fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">18</span>, <span class="dv">6</span>))  <span class="co"># 3 colonnes pour ajouter la Skew-Student</span></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Q-Q Plot pour la loi Normale</span></span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>    stats.probplot(data, dist<span class="op">=</span><span class="st">"norm"</span>, sparams<span class="op">=</span>(mu_norm, sigma_norm), plot<span class="op">=</span>axes[<span class="dv">0</span>])</span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_title(<span class="st">"Q-Q Plot - Loi Normale"</span>)</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].grid()</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Q-Q Plot pour la loi de Student</span></span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>    stats.probplot(data, dist<span class="op">=</span><span class="st">"t"</span>, sparams<span class="op">=</span>(df_t, loc_t, scale_t), plot<span class="op">=</span>axes[<span class="dv">1</span>])</span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_title(<span class="st">"Q-Q Plot - Loi de Student"</span>)</span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].grid()</span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Q-Q Plot pour la loi Skew-Student</span></span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a>    sorted_data <span class="op">=</span> np.sort(data)</span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(data)</span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a>    quantiles_skew <span class="op">=</span> skew_student_ppf((np.arange(<span class="dv">1</span>, n <span class="op">+</span> <span class="dv">1</span>) <span class="op">-</span> <span class="fl">0.5</span>) <span class="op">/</span> n, mu_skew, sigma_skew, gamma_skew, nu_skew)</span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">2</span>].scatter(quantiles_skew, sorted_data, color<span class="op">=</span><span class="st">"blue"</span>, alpha<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">2</span>].plot(quantiles_skew, quantiles_skew, <span class="st">'r--'</span>)  <span class="co"># Ligne théorique (y=x)</span></span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">2</span>].set_title(<span class="st">"Q-Q Plot - Loi Skew-Student"</span>)</span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">2</span>].grid()</span>
<span id="cb22-52"><a href="#cb22-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-53"><a href="#cb22-53" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb22-54"><a href="#cb22-54" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb22-55"><a href="#cb22-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-56"><a href="#cb22-56" aria-hidden="true" tabindex="-1"></a>    <span class="co">#  3. Test KS (Kolmogorov-Smirnov)</span></span>
<span id="cb22-57"><a href="#cb22-57" aria-hidden="true" tabindex="-1"></a>    ks_stat_norm, ks_pval_norm <span class="op">=</span> kstest(data, <span class="st">"norm"</span>, args<span class="op">=</span>(mu_norm, sigma_norm))</span>
<span id="cb22-58"><a href="#cb22-58" aria-hidden="true" tabindex="-1"></a>    ks_stat_t, ks_pval_t <span class="op">=</span> kstest(data, <span class="st">"t"</span>, args<span class="op">=</span>(df_t, loc_t, scale_t))</span>
<span id="cb22-59"><a href="#cb22-59" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-60"><a href="#cb22-60" aria-hidden="true" tabindex="-1"></a>    <span class="co"># KS-Test pour la Skew-Student</span></span>
<span id="cb22-61"><a href="#cb22-61" aria-hidden="true" tabindex="-1"></a>    np.random.seed(<span class="dv">42</span>)</span>
<span id="cb22-62"><a href="#cb22-62" aria-hidden="true" tabindex="-1"></a>    sim_data <span class="op">=</span> skew_student_sim(mu_skew, sigma_skew, gamma_skew, nu_skew, size <span class="op">=</span> <span class="dv">100_000</span>)</span>
<span id="cb22-63"><a href="#cb22-63" aria-hidden="true" tabindex="-1"></a>    ks_stat_skew, ks_pval_skew <span class="op">=</span>  kstest(data,sim_data)</span>
<span id="cb22-64"><a href="#cb22-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-65"><a href="#cb22-65" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"KS Test - Loi Normale: Stat=</span><span class="sc">{</span>ks_stat_norm<span class="sc">:.3f}</span><span class="ss">, p-value=</span><span class="sc">{</span>ks_pval_norm<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb22-66"><a href="#cb22-66" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"KS Test - Loi de Student: Stat=</span><span class="sc">{</span>ks_stat_t<span class="sc">:.3f}</span><span class="ss">, p-value=</span><span class="sc">{</span>ks_pval_t<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb22-67"><a href="#cb22-67" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"KS Test - Loi Skew-Student: Stat=</span><span class="sc">{</span>ks_stat_skew<span class="sc">:.3f}</span><span class="ss">, p-value=</span><span class="sc">{</span>ks_pval_skew<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb22-68"><a href="#cb22-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-69"><a href="#cb22-69" aria-hidden="true" tabindex="-1"></a>    <span class="co">#  4. Sélection de la meilleure distribution</span></span>
<span id="cb22-70"><a href="#cb22-70" aria-hidden="true" tabindex="-1"></a>    p_values <span class="op">=</span> {<span class="st">"Normale"</span>: ks_pval_norm, <span class="st">"Student"</span>: ks_pval_t, <span class="st">"Skew-Student"</span>: ks_pval_skew}</span>
<span id="cb22-71"><a href="#cb22-71" aria-hidden="true" tabindex="-1"></a>    best_dist <span class="op">=</span> <span class="bu">max</span>(p_values, key<span class="op">=</span>p_values.get)  <span class="co"># Sélectionne la distribution avec la plus grande p-value</span></span>
<span id="cb22-72"><a href="#cb22-72" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f" Distribution sélectionnée: </span><span class="sc">{</span>best_dist<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb22-73"><a href="#cb22-73" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-74"><a href="#cb22-74" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb22-75"><a href="#cb22-75" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Distribution"</span>: best_dist, </span>
<span id="cb22-76"><a href="#cb22-76" aria-hidden="true" tabindex="-1"></a>        <span class="st">"p-value Normale"</span>: ks_pval_norm, </span>
<span id="cb22-77"><a href="#cb22-77" aria-hidden="true" tabindex="-1"></a>        <span class="st">"p-value Student"</span>: ks_pval_t, </span>
<span id="cb22-78"><a href="#cb22-78" aria-hidden="true" tabindex="-1"></a>        <span class="st">"p-value Skew-Student"</span>: ks_pval_skew</span>
<span id="cb22-79"><a href="#cb22-79" aria-hidden="true" tabindex="-1"></a>    }</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="bb567654" class="cell" data-execution_count="20">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> skew_student <span class="im">import</span> <span class="op">*</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> kstest, norm, t, ks_2samp</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Modélisation des rendement </span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Modélisation des rendements des actions BNP</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>resultats_BNP <span class="op">=</span> modeliser_distribution(data_returns[<span class="st">"BNP"</span>])</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"--"</span><span class="op">*</span><span class="dv">30</span>,<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Modélisation des rendements des actions SG</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>resultats_SG <span class="op">=</span> modeliser_distribution(data_returns[<span class="st">"SG"</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Modélisation des rendements des actions BNP
</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\mokom\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\scipy\optimize\_differentiable_functions.py:728: UserWarning: delta_grad == 0.0. Check if the approximated function is linear. If the function is linear better results can be obtained by defining the Hessian as zero instead of using quasi-Newton approximations.
  self.H.update(delta_x, delta_g)
C:\Users\mokom\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\scipy\optimize\_differentiable_functions.py:376: UserWarning: delta_grad == 0.0. Check if the approximated function is linear. If the function is linear better results can be obtained by defining the Hessian as zero instead of using quasi-Newton approximations.
  self.H.update(self.x - self.x_prev, self.g - self.g_prev)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>-------------------- PARAMETRES ESTIMES --------------------
Loi Normale - Moyenne: -0.001, Écart-type: 0.024
Loi de Student - df: 4.533, Moyenne: -0.001, Échelle: 0.019
Loi Skew-Student - μ: 0.002, σ: 0.019, γ: -0.152, ν: 4.587
------------------------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Codes_copules_files/figure-html/cell-21-output-4.png" width="1718" height="566" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>KS Test - Loi Normale: Stat=0.055, p-value=0.004
KS Test - Loi de Student: Stat=0.026, p-value=0.487
KS Test - Loi Skew-Student: Stat=0.023, p-value=0.681
 Distribution sélectionnée: Skew-Student
------------------------------------------------------------ 

Modélisation des rendements des actions SG

-------------------- PARAMETRES ESTIMES --------------------
Loi Normale - Moyenne: -0.001, Écart-type: 0.021
Loi de Student - df: 4.593, Moyenne: -0.001, Échelle: 0.016
Loi Skew-Student - μ: -0.002, σ: 0.016, γ: 0.073, ν: 4.585
------------------------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Codes_copules_files/figure-html/cell-21-output-6.png" width="1718" height="566" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>KS Test - Loi Normale: Stat=0.049, p-value=0.015
KS Test - Loi de Student: Stat=0.025, p-value=0.559
KS Test - Loi Skew-Student: Stat=0.029, p-value=0.373
 Distribution sélectionnée: Student</code></pre>
</div>
</div>
<section id="commentaire-1" class="level4">
<h4 class="anchored" data-anchor-id="commentaire-1">Commentaire</h4>
<p>A la lecture des QQ_plot, et à l’issu des tests d’adéquation de Kolmogorov smirnov:</p>
<ul>
<li><p>les rendements de BNP s’ajustent mieux à l’aide d’une skew-student (confirmation par le test de Kolmogorov-Smirnov, p-value = 0.68). Toutefois les queues de distribution semblent ne pas être bien ajustées.</p></li>
<li><p>les rendements de SG s’ajustent aussi bien à l’aide d’une skew-student qu’à l’aide d’une student. Nous privilégions donc un modèle simple en retenant une student (p-value = 0.559, ks-test).</p></li>
</ul>
</section>
</section>
</section>
</section>
<section id="étudier-la-structure-de-dépendance-entre-les-facteurs-de-risques-sur-la-base-de-critères-non-paramétriques." class="level1">
<h1>4. Étudier la structure de dépendance entre les facteurs de risques sur la base de critères non paramétriques.</h1>
<p>Pour ce faire, nous utilisons les outils suivant:</p>
<ul>
<li><p>le dépendogramme,</p></li>
<li><p>le coefficient de spearman</p></li>
<li><p>le taux de Kendall</p></li>
</ul>
<section id="coefficient-de-spearmann-et-taux-de-kendall" class="level3">
<h3 class="anchored" data-anchor-id="coefficient-de-spearmann-et-taux-de-kendall">Coefficient de Spearmann et taux de Kendall</h3>
<div id="af6d829a" class="cell" data-execution_count="21">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> kendalltau, spearmanr</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>data_uniform <span class="op">=</span> data_returns.rank(method<span class="op">=</span><span class="st">'average'</span>, pct<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul du tau de Kendall</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>tau, p_value_tau <span class="op">=</span> kendalltau(data_uniform[<span class="st">'BNP'</span>], data_uniform[<span class="st">'SG'</span>])</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul du coefficient de Spearman</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>spearman_corr, p_value_spearman <span class="op">=</span> spearmanr(data_uniform[<span class="st">'BNP'</span>], data_uniform[<span class="st">'SG'</span>])</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Tau de Kendall: </span><span class="sc">{</span>tau<span class="sc">:.4f}</span><span class="ss"> (p-value: </span><span class="sc">{</span>p_value_tau<span class="sc">:.4f}</span><span class="ss">)"</span>)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Coefficient de Spearman: </span><span class="sc">{</span>spearman_corr<span class="sc">:.4f}</span><span class="ss"> (p-value: </span><span class="sc">{</span>p_value_spearman<span class="sc">:.4f}</span><span class="ss">)"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Tau de Kendall: 0.6691 (p-value: 0.0000)
Coefficient de Spearman: 0.8410 (p-value: 0.0000)</code></pre>
</div>
</div>
<section id="commentaire-2" class="level4">
<h4 class="anchored" data-anchor-id="commentaire-2">Commentaire:</h4>
<p>Les coefficients de corrélation de Kendall et de Spearman révèlent une concordance significative entre les log-rendements de BNP et de Société Générale. Ces résultats indiquent que les deux séries temporelles évoluent généralement dans la même direction.</p>
</section>
</section>
<section id="dépendogramme" class="level2">
<h2 class="anchored" data-anchor-id="dépendogramme">Dépendogramme</h2>
<div id="933fc8db" class="cell" data-execution_count="22">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>data_uniform <span class="op">=</span> data_returns.rank(method<span class="op">=</span><span class="st">'average'</span>, pct<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Nuage de points</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>plt.scatter(data_uniform[<span class="st">'BNP'</span>], data_uniform[<span class="st">'SG'</span>])</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"BNP"</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"SG"</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Scatter plot BNP vs SG"</span>)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Codes_copules_files/figure-html/cell-23-output-1.png" width="589" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="lanalyse-du-dépendodogramme-suggère-une-dependance-de-queue-dans-nos-données-principalement-marquée-à-droite." class="level4">
<h4 class="anchored" data-anchor-id="lanalyse-du-dépendodogramme-suggère-une-dependance-de-queue-dans-nos-données-principalement-marquée-à-droite.">L’analyse du dépendodogramme suggère une dependance de queue dans nos données principalement marquée à droite.</h4>
</section>
</section>
</section>
<section id="modéliser-la-structure-de-dépendance-au-moyen-des-copules-paramétriques-suivantes" class="level1">
<h1>5. Modéliser la structure de dépendance au moyen des copules paramétriques suivantes :</h1>
<section id="a.-copules-elliptiques-gaussienne-student." class="level2">
<h2 class="anchored" data-anchor-id="a.-copules-elliptiques-gaussienne-student.">5.a. Copules elliptiques : gaussienne, Student.</h2>
<div id="08be441f" class="cell" data-execution_count="23">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> copulae <span class="im">import</span> GaussianCopula</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Correction des index dupliqués</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>data_returns <span class="op">=</span> data_returns.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Transformation des données en rangs (pour obtenir des valeurs uniformes dans [0, 1])</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>rank_data <span class="op">=</span> data_returns.rank() <span class="op">/</span> (<span class="bu">len</span>(data_returns) <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Ajustement de la copule Gaussienne sur les rangs</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>copula_gaussian <span class="op">=</span> GaussianCopula()  <span class="co"># 2 variables</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>copula_gaussian.fit(rank_data.values)</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Génération d'échantillons de la copule (valeurs sur [0, 1])</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> copula_gaussian.random(<span class="bu">len</span>(data_returns))</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Transformation inverse des rangs vers l'échelle originale</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Utilisation de np.percentile qui prend en argument les pourcentages (multipliez par 100)</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>simulated_BNP <span class="op">=</span> np.percentile(data_returns[<span class="st">'BNP'</span>], samples[:, <span class="dv">0</span>] <span class="op">*</span> <span class="dv">100</span>)</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>simulated_SG  <span class="op">=</span> np.percentile(data_returns[<span class="st">'SG'</span>], samples[:, <span class="dv">1</span>] <span class="op">*</span> <span class="dv">100</span>)</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>simulated_returns <span class="op">=</span> pd.DataFrame({</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">'BNP'</span>: simulated_BNP,</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">'SG'</span>: simulated_SG</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Visualisation</span></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>plt.scatter(rank_data[<span class="st">'BNP'</span>], rank_data[<span class="st">'SG'</span>], alpha<span class="op">=</span><span class="fl">0.5</span>, label<span class="op">=</span><span class="st">"Données réelles"</span>, color<span class="op">=</span><span class="st">"blue"</span>)</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>plt.scatter(samples[:, <span class="dv">0</span>], samples[:, <span class="dv">1</span>], alpha<span class="op">=</span><span class="fl">0.5</span>, label<span class="op">=</span><span class="st">"Simulées (Copule Gaussienne)"</span>, color<span class="op">=</span><span class="st">"green"</span>)</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"BNP"</span>)</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"SG"</span>)</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Copule Gaussienne : Réelles vs simulées"</span>)</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Codes_copules_files/figure-html/cell-24-output-1.png" width="812" height="450" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="fa3962a6" class="cell" data-execution_count="24">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>copula_gaussian.summary()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="24">
<div>
    <h2 class="anchored">Gaussian Copula Summary</h2>
    <div>Gaussian Copula with 2 dimensions</div>
    <hr>
    
<div>
    <h3 class="anchored">Parameters</h3>
    <strong>Correlation Matrix</strong>
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<tbody>
<tr class="odd">
<td>1.000000</td>
<td>0.860948</td>
</tr>
<tr class="even">
<td>0.860948</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

</div>

</div>
</div>
</div>
</section>
</section>
<section id="modéliser-la-structure-de-dépendance-au-moyen-des-copules-paramétriques-suivantes-1" class="level1">
<h1>5. Modéliser la structure de dépendance au moyen des copules paramétriques suivantes :</h1>
<section id="copules-elliptiques-gaussienne-student." class="level2">
<h2 class="anchored" data-anchor-id="copules-elliptiques-gaussienne-student.">Copules elliptiques : gaussienne, Student.</h2>
<div id="6dd83272" class="cell" data-execution_count="25">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> t <span class="im">as</span> t_dist</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.optimize <span class="im">import</span> minimize</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> log, gamma, pi, sqrt</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co"># =============================================================================</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Fonctions de densité t-Student (univariée &amp; bivariée) en log</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="co"># =============================================================================</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> log_t_pdf_univariate(x, df):</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="co">    Retourne ln[f_nu(x)] pour la loi t univariée de df degrés de liberté.</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="co">    Formule :</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="co">      f_nu(x) = Gamma((df+1)/2) / [ sqrt(df*pi)*Gamma(df/2) ] * [1 + x^2/df]^(-(df+1)/2)</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>    c1 <span class="op">=</span> np.log(gamma((df<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)) <span class="op">-</span> np.log(gamma(df<span class="op">/</span><span class="dv">2</span>)) <span class="op">-</span> <span class="fl">0.5</span><span class="op">*</span>np.log(df<span class="op">*</span>pi)</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>    c2 <span class="op">=</span> <span class="op">-</span>(df<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span> <span class="op">*</span> np.log(<span class="dv">1</span> <span class="op">+</span> x<span class="op">**</span><span class="dv">2</span><span class="op">/</span>df)</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> c1 <span class="op">+</span> c2</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> log_t_pdf_bivariate(x, y, df, r):</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a><span class="co">    Retourne ln[f_{df,r}(x,y)] pour la t-Student bivariée, corrélation r, df degrés de liberté.</span></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a><span class="co">      f_{df,r}(x,y) =</span></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a><span class="co">         Gamma((df+2)/2) / [ Gamma(df/2) * (pi*df) * sqrt(1-r^2) ]</span></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a><span class="co">         * [1 + 1/df * (x^2 - 2rxy + y^2)/(1-r^2)]^(-(df+2)/2)</span></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a><span class="co">    On renvoie le log de cette densité.</span></span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Partie constante</span></span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>    log_num_gamma <span class="op">=</span> np.log(gamma((df<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>)) <span class="op">-</span> np.log(gamma(df<span class="op">/</span><span class="dv">2</span>))</span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>    log_denom <span class="op">=</span> np.log(pi<span class="op">*</span>df) <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span>np.log(<span class="dv">1</span> <span class="op">-</span> r<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>    cst <span class="op">=</span> log_num_gamma <span class="op">-</span> log_denom</span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Partie quadratique</span></span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>    quad <span class="op">=</span> (x<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> <span class="dv">2</span><span class="op">*</span>r<span class="op">*</span>x<span class="op">*</span>y <span class="op">+</span> y<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span>(<span class="dv">1</span> <span class="op">-</span> r<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>    log_noyau <span class="op">=</span> <span class="op">-</span> (df<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span> <span class="op">*</span> np.log(<span class="dv">1</span> <span class="op">+</span> quad<span class="op">/</span>df)</span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cst <span class="op">+</span> log_noyau</span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a><span class="co"># =============================================================================</span></span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Log-densité de la copule t-Student (bivariée)</span></span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a><span class="co"># =============================================================================</span></span>
<span id="cb34-45"><a href="#cb34-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-46"><a href="#cb34-46" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> log_student_copula_2d(u1, u2, df, r):</span>
<span id="cb34-47"><a href="#cb34-47" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb34-48"><a href="#cb34-48" aria-hidden="true" tabindex="-1"></a><span class="co">    Calcule ln[c_{df,r}(u1,u2)] = ln f_{df,r}(x,y) - [ln f_df(x) + ln f_df(y)],</span></span>
<span id="cb34-49"><a href="#cb34-49" aria-hidden="true" tabindex="-1"></a><span class="co">    où x = t_{df}^{-1}(u1) et y = t_{df}^{-1}(u2).</span></span>
<span id="cb34-50"><a href="#cb34-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-51"><a href="#cb34-51" aria-hidden="true" tabindex="-1"></a><span class="co">    - u1, u2 dans [0,1].</span></span>
<span id="cb34-52"><a href="#cb34-52" aria-hidden="true" tabindex="-1"></a><span class="co">    - df &gt; 0, r in (-1,1).</span></span>
<span id="cb34-53"><a href="#cb34-53" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb34-54"><a href="#cb34-54" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Inversion via la quantile function (ppf) univariée</span></span>
<span id="cb34-55"><a href="#cb34-55" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> t_dist.ppf(u1, df)</span>
<span id="cb34-56"><a href="#cb34-56" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> t_dist.ppf(u2, df)</span>
<span id="cb34-57"><a href="#cb34-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-58"><a href="#cb34-58" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Log densité jointe</span></span>
<span id="cb34-59"><a href="#cb34-59" aria-hidden="true" tabindex="-1"></a>    log_joint <span class="op">=</span> log_t_pdf_bivariate(x, y, df, r)</span>
<span id="cb34-60"><a href="#cb34-60" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Log densités marginales (univariées)</span></span>
<span id="cb34-61"><a href="#cb34-61" aria-hidden="true" tabindex="-1"></a>    log_marg_x <span class="op">=</span> log_t_pdf_univariate(x, df)</span>
<span id="cb34-62"><a href="#cb34-62" aria-hidden="true" tabindex="-1"></a>    log_marg_y <span class="op">=</span> log_t_pdf_univariate(y, df)</span>
<span id="cb34-63"><a href="#cb34-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-64"><a href="#cb34-64" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> log_joint <span class="op">-</span> (log_marg_x <span class="op">+</span> log_marg_y)</span>
<span id="cb34-65"><a href="#cb34-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-66"><a href="#cb34-66" aria-hidden="true" tabindex="-1"></a><span class="co"># =============================================================================</span></span>
<span id="cb34-67"><a href="#cb34-67" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) Log-vraisemblance négative</span></span>
<span id="cb34-68"><a href="#cb34-68" aria-hidden="true" tabindex="-1"></a><span class="co"># =============================================================================</span></span>
<span id="cb34-69"><a href="#cb34-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-70"><a href="#cb34-70" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> negative_log_likelihood(params, data):</span>
<span id="cb34-71"><a href="#cb34-71" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb34-72"><a href="#cb34-72" aria-hidden="true" tabindex="-1"></a><span class="co">    Calcule - somme [ ln c_{df,r}(u1,u2) ] sur tout l'échantillon.</span></span>
<span id="cb34-73"><a href="#cb34-73" aria-hidden="true" tabindex="-1"></a><span class="co">    data : array shape (n,2) contenant les (u1,u2) dans [0,1].</span></span>
<span id="cb34-74"><a href="#cb34-74" aria-hidden="true" tabindex="-1"></a><span class="co">    params : (alpha, beta) --&gt; r, df via reparamétrage :</span></span>
<span id="cb34-75"><a href="#cb34-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-76"><a href="#cb34-76" aria-hidden="true" tabindex="-1"></a><span class="co">      r  = tanh(alpha)   --&gt; r in (-1,1)</span></span>
<span id="cb34-77"><a href="#cb34-77" aria-hidden="true" tabindex="-1"></a><span class="co">      df = 2 + log(1 + exp(beta))  --&gt; df &gt; 2 (par exemple)</span></span>
<span id="cb34-78"><a href="#cb34-78" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb34-79"><a href="#cb34-79" aria-hidden="true" tabindex="-1"></a>    alpha, beta <span class="op">=</span> params</span>
<span id="cb34-80"><a href="#cb34-80" aria-hidden="true" tabindex="-1"></a>    r <span class="op">=</span> np.tanh(alpha)  <span class="co"># in (-1,1)</span></span>
<span id="cb34-81"><a href="#cb34-81" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> <span class="fl">2.0</span> <span class="op">+</span> np.log1p(np.exp(beta))  <span class="co"># &gt; 2</span></span>
<span id="cb34-82"><a href="#cb34-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-83"><a href="#cb34-83" aria-hidden="true" tabindex="-1"></a>    ll <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb34-84"><a href="#cb34-84" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (u1, u2) <span class="kw">in</span> data:</span>
<span id="cb34-85"><a href="#cb34-85" aria-hidden="true" tabindex="-1"></a>        ll <span class="op">+=</span> log_student_copula_2d(u1, u2, df, r)</span>
<span id="cb34-86"><a href="#cb34-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-87"><a href="#cb34-87" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span>ll  <span class="co"># On renvoie la -log-vraisemblance</span></span>
<span id="cb34-88"><a href="#cb34-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-89"><a href="#cb34-89" aria-hidden="true" tabindex="-1"></a><span class="co"># =============================================================================</span></span>
<span id="cb34-90"><a href="#cb34-90" aria-hidden="true" tabindex="-1"></a><span class="co"># 4) Fonction d'ajustement (fit) par MLE</span></span>
<span id="cb34-91"><a href="#cb34-91" aria-hidden="true" tabindex="-1"></a><span class="co"># =============================================================================</span></span>
<span id="cb34-92"><a href="#cb34-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-93"><a href="#cb34-93" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fit_student_copula_2d(data, alpha0<span class="op">=</span><span class="fl">0.0</span>, beta0<span class="op">=</span><span class="fl">1.0</span>):</span>
<span id="cb34-94"><a href="#cb34-94" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb34-95"><a href="#cb34-95" aria-hidden="true" tabindex="-1"></a><span class="co">    Ajuste la copule t-Student bivariée à un échantillon de pseudo-observations 'data' (n,2).</span></span>
<span id="cb34-96"><a href="#cb34-96" aria-hidden="true" tabindex="-1"></a><span class="co">    Minimisation de la -log-vraisemblance w.r.t. (alpha,beta).</span></span>
<span id="cb34-97"><a href="#cb34-97" aria-hidden="true" tabindex="-1"></a><span class="co">      alpha0, beta0 : valeurs initiales pour (alpha, beta).</span></span>
<span id="cb34-98"><a href="#cb34-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-99"><a href="#cb34-99" aria-hidden="true" tabindex="-1"></a><span class="co">    Retourne un dict contenant r, df, logLik, etc.</span></span>
<span id="cb34-100"><a href="#cb34-100" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb34-101"><a href="#cb34-101" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> minimize(</span>
<span id="cb34-102"><a href="#cb34-102" aria-hidden="true" tabindex="-1"></a>        fun<span class="op">=</span>negative_log_likelihood,</span>
<span id="cb34-103"><a href="#cb34-103" aria-hidden="true" tabindex="-1"></a>        x0<span class="op">=</span>np.array([alpha0, beta0]),</span>
<span id="cb34-104"><a href="#cb34-104" aria-hidden="true" tabindex="-1"></a>        args<span class="op">=</span>(data,),</span>
<span id="cb34-105"><a href="#cb34-105" aria-hidden="true" tabindex="-1"></a>        method<span class="op">=</span><span class="st">'Nelder-Mead'</span></span>
<span id="cb34-106"><a href="#cb34-106" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb34-107"><a href="#cb34-107" aria-hidden="true" tabindex="-1"></a>    alpha_hat, beta_hat <span class="op">=</span> res.x</span>
<span id="cb34-108"><a href="#cb34-108" aria-hidden="true" tabindex="-1"></a>    r_hat <span class="op">=</span> np.tanh(alpha_hat)</span>
<span id="cb34-109"><a href="#cb34-109" aria-hidden="true" tabindex="-1"></a>    df_hat <span class="op">=</span> <span class="fl">2.0</span> <span class="op">+</span> np.log1p(np.exp(beta_hat))</span>
<span id="cb34-110"><a href="#cb34-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-111"><a href="#cb34-111" aria-hidden="true" tabindex="-1"></a>    ll_hat <span class="op">=</span> <span class="op">-</span>res.fun  <span class="co"># log-vraisemblance au point optimum</span></span>
<span id="cb34-112"><a href="#cb34-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-113"><a href="#cb34-113" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb34-114"><a href="#cb34-114" aria-hidden="true" tabindex="-1"></a>        <span class="st">'r'</span>: r_hat,</span>
<span id="cb34-115"><a href="#cb34-115" aria-hidden="true" tabindex="-1"></a>        <span class="st">'df'</span>: df_hat,</span>
<span id="cb34-116"><a href="#cb34-116" aria-hidden="true" tabindex="-1"></a>        <span class="st">'logLik'</span>: ll_hat,</span>
<span id="cb34-117"><a href="#cb34-117" aria-hidden="true" tabindex="-1"></a>        <span class="st">'success'</span>: res.success,</span>
<span id="cb34-118"><a href="#cb34-118" aria-hidden="true" tabindex="-1"></a>        <span class="st">'message'</span>: res.message</span>
<span id="cb34-119"><a href="#cb34-119" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb34-120"><a href="#cb34-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-121"><a href="#cb34-121" aria-hidden="true" tabindex="-1"></a><span class="co"># =============================================================================</span></span>
<span id="cb34-122"><a href="#cb34-122" aria-hidden="true" tabindex="-1"></a><span class="co"># 5) Utilisation sur données data_returns</span></span>
<span id="cb34-123"><a href="#cb34-123" aria-hidden="true" tabindex="-1"></a><span class="co"># =============================================================================</span></span>
<span id="cb34-124"><a href="#cb34-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-125"><a href="#cb34-125" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Transformer vos rendements en pseudo-observations dans [0,1]</span></span>
<span id="cb34-126"><a href="#cb34-126" aria-hidden="true" tabindex="-1"></a>rank_data <span class="op">=</span> data_returns.rank(method<span class="op">=</span><span class="st">'average'</span>) <span class="op">/</span> (<span class="bu">len</span>(data_returns) <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb34-127"><a href="#cb34-127" aria-hidden="true" tabindex="-1"></a>u_data <span class="op">=</span> rank_data.values  <span class="co"># numpy array de taille (n,2)</span></span>
<span id="cb34-128"><a href="#cb34-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-129"><a href="#cb34-129" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Ajustement de la copule t-Student bivariée par MLE</span></span>
<span id="cb34-130"><a href="#cb34-130" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> fit_student_copula_2d(u_data, alpha0<span class="op">=</span><span class="fl">0.0</span>, beta0<span class="op">=</span><span class="fl">1.0</span>)</span>
<span id="cb34-131"><a href="#cb34-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-132"><a href="#cb34-132" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"=== Estimation Copule t-Student Bivariée ==="</span>)</span>
<span id="cb34-133"><a href="#cb34-133" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Paramètre r estimé = </span><span class="sc">{</span>result[<span class="st">'r'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb34-134"><a href="#cb34-134" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Paramètre df estimé = </span><span class="sc">{</span>result[<span class="st">'df'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb34-135"><a href="#cb34-135" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Log-vraisemblance  = </span><span class="sc">{</span>result[<span class="st">'logLik'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb34-136"><a href="#cb34-136" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Convergence :"</span>, result[<span class="st">'success'</span>], <span class="st">"|"</span>, result[<span class="st">'message'</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>=== Estimation Copule t-Student Bivariée ===
Paramètre r estimé = 0.8496
Paramètre df estimé = 2.0000
Log-vraisemblance  = 719.7436
Convergence : True | Optimization terminated successfully.</code></pre>
</div>
</div>
<div id="3ea6ab96" class="cell" data-execution_count="26">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> copulae <span class="im">import</span> GaussianCopula, StudentCopula, GumbelCopula, FrankCopula, ClaytonCopula</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> kendalltau, spearmanr</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Chargement des données</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>data_returns <span class="op">=</span> data_returns.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformation en pseudo-observations (rangs normalisés)</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>rank_data <span class="op">=</span> data_returns.rank() <span class="op">/</span> (<span class="bu">len</span>(data_returns) <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Définition des copules</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>copules <span class="op">=</span> {</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gaussian"</span>: GaussianCopula(dim<span class="op">=</span><span class="dv">2</span>),</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Student-t"</span>: StudentCopula(dim<span class="op">=</span><span class="dv">2</span>, df<span class="op">=</span><span class="dv">2</span>),</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gumbel"</span>: GumbelCopula(dim<span class="op">=</span><span class="dv">2</span>),</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Frank"</span>: FrankCopula(dim<span class="op">=</span><span class="dv">2</span>),</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Clayton"</span>: ClaytonCopula(dim<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustement des copules aux données empiriques</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>fit_results <span class="op">=</span> {}</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, cop <span class="kw">in</span> copules.items():</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> name <span class="op">==</span> <span class="st">"Student-t"</span>:</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>        cop.fit(rank_data.values, fix_df<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>        cop.fit(rank_data.values)</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>    fit_results[name] <span class="op">=</span> cop</span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparaison des mesures de dépendance</span></span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>empirical_tau, _ <span class="op">=</span> kendalltau(data_returns[<span class="st">"BNP"</span>], data_returns[<span class="st">"SG"</span>])</span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>empirical_rho, _ <span class="op">=</span> spearmanr(data_returns[<span class="st">"BNP"</span>], data_returns[<span class="st">"SG"</span>])</span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> []</span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, cop <span class="kw">in</span> fit_results.items():</span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>    simulated_data <span class="op">=</span> cop.random(<span class="bu">len</span>(data_returns))</span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>    sim_tau, _ <span class="op">=</span> kendalltau(simulated_data[:, <span class="dv">0</span>], simulated_data[:, <span class="dv">1</span>])</span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a>    sim_rho, _ <span class="op">=</span> spearmanr(simulated_data[:, <span class="dv">0</span>], simulated_data[:, <span class="dv">1</span>])</span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Nouveau calcul de la log-vraisemblance via la densité jointe</span></span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a>    log_likelihood <span class="op">=</span> np.<span class="bu">sum</span>(np.log(cop.pdf(rank_data.values)))</span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a>    results.append([name, log_likelihood, <span class="bu">abs</span>(sim_tau <span class="op">-</span> empirical_tau), <span class="bu">abs</span>(sim_rho <span class="op">-</span> empirical_rho)])</span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Affichage des résultats</span></span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a>results_df <span class="op">=</span> pd.DataFrame(results, columns<span class="op">=</span>[<span class="st">"Copule"</span>, <span class="st">"Log-Vraisemblance"</span>, <span class="st">"Erreur Kendall Tau"</span>, <span class="st">"Erreur Spearman Rho"</span>])</span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(results_df.sort_values(by<span class="op">=</span><span class="st">"Log-Vraisemblance"</span>, ascending<span class="op">=</span><span class="va">False</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      Copule  Log-Vraisemblance  Erreur Kendall Tau  Erreur Spearman Rho
1  Student-t         720.838328            0.003462             0.000855
2     Gumbel         703.146279            0.007835             0.004465
0   Gaussian         670.141798            0.000534             0.016872
3      Frank         630.219249            0.001741             0.023079
4    Clayton         517.723513            0.091739             0.073704</code></pre>
</div>
</div>
<div id="96dc582d" class="cell" data-execution_count="27">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisation des distributions simulées</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, (name, cop) <span class="kw">in</span> <span class="bu">enumerate</span>(fit_results.items(), <span class="dv">1</span>):</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    simulated_data <span class="op">=</span> cop.random(<span class="bu">len</span>(data_returns))</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    plt.subplot(<span class="dv">3</span>, <span class="dv">2</span>, i)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    plt.scatter(rank_data[<span class="st">"BNP"</span>], rank_data[<span class="st">"SG"</span>], alpha<span class="op">=</span><span class="fl">0.5</span>, label<span class="op">=</span><span class="st">"Données réelles"</span>, color<span class="op">=</span><span class="st">"blue"</span>)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    plt.scatter(simulated_data[:, <span class="dv">0</span>], simulated_data[:, <span class="dv">1</span>], alpha<span class="op">=</span><span class="fl">0.5</span>, label<span class="op">=</span><span class="ss">f"Simulées (</span><span class="sc">{</span>name<span class="sc">}</span><span class="ss">)"</span>, color<span class="op">=</span><span class="st">"green"</span>)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="ss">f"Copule </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">"BNP"</span>)</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">"SG"</span>)</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>    plt.legend()</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Codes_copules_files/figure-html/cell-28-output-1.png" width="1142" height="758" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="83596472" class="cell" data-execution_count="28">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> gaussian_kde</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>rank_data <span class="op">=</span> data_returns.rank() <span class="op">/</span> (<span class="bu">len</span>(data_returns) <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>u <span class="op">=</span> rank_data.iloc[:, <span class="dv">0</span>].values</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>v <span class="op">=</span> rank_data.iloc[:, <span class="dv">1</span>].values</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="bu">len</span>(u)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul de la statistique empirique V_i (distribution de Kendall)</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> (u[:, np.newaxis] <span class="op">&lt;=</span> u) <span class="op">&amp;</span> (v[:, np.newaxis] <span class="op">&lt;=</span> v)</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>counts <span class="op">=</span> mask.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>V <span class="op">=</span> (counts <span class="op">-</span> <span class="dv">1</span>) <span class="op">/</span> (n <span class="op">-</span> <span class="dv">1</span>)  <span class="co"># Ajustement pour l'auto-comparaison</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>V_trié <span class="op">=</span> np.sort(V)</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Définition des copules à tester</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>copules <span class="op">=</span> {</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gaussienne"</span>: GaussianCopula(dim<span class="op">=</span><span class="dv">2</span>),</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Student-t"</span>: StudentCopula(dim<span class="op">=</span><span class="dv">2</span>, df<span class="op">=</span><span class="dv">2</span>),</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gumbel"</span>: GumbelCopula(dim<span class="op">=</span><span class="dv">2</span>),</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Frank"</span>: FrankCopula(dim<span class="op">=</span><span class="dv">2</span>),</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Clayton"</span>: ClaytonCopula(dim<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Paramètres de simulation</span></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>nb_simulations <span class="op">=</span> <span class="dv">100</span>  <span class="co"># Augmenter pour un résultat plus lisse</span></span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Génération des graphiques de Kendall</span></span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>))</span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, (nom, copule) <span class="kw">in</span> <span class="bu">enumerate</span>(copules.items(), <span class="dv">1</span>):</span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ajustement de la copule aux données</span></span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> nom <span class="op">==</span> <span class="st">"Student-t"</span>:</span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>        copule.fit(rank_data.values, fix_df<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a>        copule.fit(rank_data.values)</span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Simulation de plusieurs jeux de données et calcul des statistiques V</span></span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a>    V_simulé <span class="op">=</span> np.zeros((nb_simulations, n))</span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> s <span class="kw">in</span> <span class="bu">range</span>(nb_simulations):</span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Génération de données synthétiques à partir de la copule ajustée</span></span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a>        données_simulées <span class="op">=</span> copule.random(n)</span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calcul de V pour les données simulées</span></span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a>        u_sim <span class="op">=</span> données_simulées[:, <span class="dv">0</span>]</span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a>        v_sim <span class="op">=</span> données_simulées[:, <span class="dv">1</span>]</span>
<span id="cb39-46"><a href="#cb39-46" aria-hidden="true" tabindex="-1"></a>        mask_sim <span class="op">=</span> (u_sim[:, np.newaxis] <span class="op">&lt;=</span> u_sim) <span class="op">&amp;</span> (v_sim[:, np.newaxis] <span class="op">&lt;=</span> v_sim)</span>
<span id="cb39-47"><a href="#cb39-47" aria-hidden="true" tabindex="-1"></a>        counts_sim <span class="op">=</span> mask_sim.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb39-48"><a href="#cb39-48" aria-hidden="true" tabindex="-1"></a>        V_sim <span class="op">=</span> (counts_sim <span class="op">-</span> <span class="dv">1</span>) <span class="op">/</span> (n <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb39-49"><a href="#cb39-49" aria-hidden="true" tabindex="-1"></a>        V_simulé[s] <span class="op">=</span> np.sort(V_sim)  <span class="co"># Tri des valeurs simulées</span></span>
<span id="cb39-50"><a href="#cb39-50" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-51"><a href="#cb39-51" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calcul des valeurs moyennes attendues à partir des simulations</span></span>
<span id="cb39-52"><a href="#cb39-52" aria-hidden="true" tabindex="-1"></a>    V_attendu <span class="op">=</span> V_simulé.mean(axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb39-53"><a href="#cb39-53" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-54"><a href="#cb39-54" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Tracé du graphique de Kendall avec une ligne fine pour mieux voir l'ajustement</span></span>
<span id="cb39-55"><a href="#cb39-55" aria-hidden="true" tabindex="-1"></a>    plt.subplot(<span class="dv">3</span>, <span class="dv">2</span>, i)</span>
<span id="cb39-56"><a href="#cb39-56" aria-hidden="true" tabindex="-1"></a>    plt.plot(V_attendu, V_trié, lw<span class="op">=</span><span class="dv">1</span>, color<span class="op">=</span><span class="st">'blue'</span>, label<span class="op">=</span><span class="st">'Données vs Copule'</span>)</span>
<span id="cb39-57"><a href="#cb39-57" aria-hidden="true" tabindex="-1"></a>    plt.plot([<span class="dv">0</span>, <span class="dv">1</span>], [<span class="dv">0</span>, <span class="dv">1</span>], <span class="st">'--r'</span>, lw<span class="op">=</span><span class="dv">1</span>, label<span class="op">=</span><span class="st">'Ajustement parfait'</span>)</span>
<span id="cb39-58"><a href="#cb39-58" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="ss">f'Valeurs attendues (</span><span class="sc">{</span>nom<span class="sc">}</span><span class="ss">)'</span>)</span>
<span id="cb39-59"><a href="#cb39-59" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">'Valeurs empiriques'</span>)</span>
<span id="cb39-60"><a href="#cb39-60" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="ss">f'Copule </span><span class="sc">{</span>nom<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb39-61"><a href="#cb39-61" aria-hidden="true" tabindex="-1"></a>    plt.legend()</span>
<span id="cb39-62"><a href="#cb39-62" aria-hidden="true" tabindex="-1"></a>    plt.grid(<span class="va">True</span>)</span>
<span id="cb39-63"><a href="#cb39-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-64"><a href="#cb39-64" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb39-65"><a href="#cb39-65" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Codes_copules_files/figure-html/cell-29-output-1.png" width="950" height="950" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="1d3f49b7" class="cell" data-execution_count="29">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> gaussian_kde</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Configuration</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>grid_size <span class="op">=</span> <span class="dv">100</span>        <span class="co"># Résolution de la grille</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>contour_levels <span class="op">=</span> <span class="dv">15</span>    <span class="co"># Nombre de niveaux de contour</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Préparation des données : transformation en marges uniformes par rang</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>rank_data <span class="op">=</span> data_returns.rank() <span class="op">/</span> (<span class="bu">len</span>(data_returns) <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>u <span class="op">=</span> rank_data.iloc[:, <span class="dv">0</span>]</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>v <span class="op">=</span> rank_data.iloc[:, <span class="dv">1</span>]</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Création de la grille d'évaluation</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, grid_size)</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, grid_size)</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(x, y)</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>grid_points <span class="op">=</span> np.vstack([X.ravel(), Y.ravel()]).T</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul de la KDE empirique sur les données observées</span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>empirical_kernel <span class="op">=</span> gaussian_kde(rank_data.values.T)</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>Z_empirical <span class="op">=</span> empirical_kernel(grid_points.T).reshape(X.shape)</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Définition des copules à comparer</span></span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>copulas <span class="op">=</span> {</span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gaussian"</span>: GaussianCopula(dim<span class="op">=</span><span class="dv">2</span>),</span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Student"</span>: StudentCopula(dim<span class="op">=</span><span class="dv">2</span>, df<span class="op">=</span><span class="dv">2</span>),</span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gumbel"</span>: GumbelCopula(dim<span class="op">=</span><span class="dv">2</span>),</span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Frank"</span>: FrankCopula(dim<span class="op">=</span><span class="dv">2</span>),</span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Clayton"</span>: ClaytonCopula(dim<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Nombre d'observations simulées pour estimer la KDE théorique</span></span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a>n_sim <span class="op">=</span> <span class="dv">5000</span></span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Création de la figure avec une ligne par copule et 2 colonnes (empirique vs théorique)</span></span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="bu">len</span>(copulas), ncols<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">25</span>))</span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(hspace<span class="op">=</span><span class="fl">0.4</span>)</span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-38"><a href="#cb40-38" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, (name, copula) <span class="kw">in</span> <span class="bu">enumerate</span>(copulas.items()):</span>
<span id="cb40-39"><a href="#cb40-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ajustement de la copule aux données</span></span>
<span id="cb40-40"><a href="#cb40-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> name <span class="op">==</span> <span class="st">"Student"</span>:</span>
<span id="cb40-41"><a href="#cb40-41" aria-hidden="true" tabindex="-1"></a>        copula.fit(rank_data.values, fix_df<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb40-42"><a href="#cb40-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb40-43"><a href="#cb40-43" aria-hidden="true" tabindex="-1"></a>        copula.fit(rank_data.values)</span>
<span id="cb40-44"><a href="#cb40-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-45"><a href="#cb40-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Simulation d'un échantillon théorique à partir de la copule ajustée</span></span>
<span id="cb40-46"><a href="#cb40-46" aria-hidden="true" tabindex="-1"></a>    simulated_data <span class="op">=</span> copula.random(n_sim)</span>
<span id="cb40-47"><a href="#cb40-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-48"><a href="#cb40-48" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calcul de la KDE théorique à partir de l'échantillon simulé</span></span>
<span id="cb40-49"><a href="#cb40-49" aria-hidden="true" tabindex="-1"></a>    theoretical_kernel <span class="op">=</span> gaussian_kde(simulated_data.T)</span>
<span id="cb40-50"><a href="#cb40-50" aria-hidden="true" tabindex="-1"></a>    Z_theoretical <span class="op">=</span> theoretical_kernel(grid_points.T).reshape(X.shape)</span>
<span id="cb40-51"><a href="#cb40-51" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-52"><a href="#cb40-52" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Affichage de la KDE empirique</span></span>
<span id="cb40-53"><a href="#cb40-53" aria-hidden="true" tabindex="-1"></a>    ax_emp <span class="op">=</span> axs[idx, <span class="dv">0</span>]</span>
<span id="cb40-54"><a href="#cb40-54" aria-hidden="true" tabindex="-1"></a>    cf_emp <span class="op">=</span> ax_emp.contourf(X, Y, Z_empirical, levels<span class="op">=</span>contour_levels, cmap<span class="op">=</span><span class="st">'viridis'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb40-55"><a href="#cb40-55" aria-hidden="true" tabindex="-1"></a>    ax_emp.scatter(u, v, s<span class="op">=</span><span class="dv">10</span>, color<span class="op">=</span><span class="st">'white'</span>, edgecolors<span class="op">=</span><span class="st">'black'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb40-56"><a href="#cb40-56" aria-hidden="true" tabindex="-1"></a>    ax_emp.set_title(<span class="ss">f'</span><span class="sc">{</span>name<span class="sc">}</span><span class="ss"> Copule - KDE Empirique'</span>)</span>
<span id="cb40-57"><a href="#cb40-57" aria-hidden="true" tabindex="-1"></a>    ax_emp.set_xlabel(<span class="st">'u'</span>)</span>
<span id="cb40-58"><a href="#cb40-58" aria-hidden="true" tabindex="-1"></a>    ax_emp.set_ylabel(<span class="st">'v'</span>)</span>
<span id="cb40-59"><a href="#cb40-59" aria-hidden="true" tabindex="-1"></a>    ax_emp.grid(<span class="va">True</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb40-60"><a href="#cb40-60" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-61"><a href="#cb40-61" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Affichage de la KDE théorique</span></span>
<span id="cb40-62"><a href="#cb40-62" aria-hidden="true" tabindex="-1"></a>    ax_theo <span class="op">=</span> axs[idx, <span class="dv">1</span>]</span>
<span id="cb40-63"><a href="#cb40-63" aria-hidden="true" tabindex="-1"></a>    cf_theo <span class="op">=</span> ax_theo.contourf(X, Y, Z_theoretical, levels<span class="op">=</span>contour_levels, cmap<span class="op">=</span><span class="st">'viridis'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb40-64"><a href="#cb40-64" aria-hidden="true" tabindex="-1"></a>    ax_theo.scatter(u, v, s<span class="op">=</span><span class="dv">10</span>, color<span class="op">=</span><span class="st">'white'</span>, edgecolors<span class="op">=</span><span class="st">'black'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb40-65"><a href="#cb40-65" aria-hidden="true" tabindex="-1"></a>    ax_theo.set_title(<span class="ss">f'Copule </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss"> - KDE Théorique'</span>)</span>
<span id="cb40-66"><a href="#cb40-66" aria-hidden="true" tabindex="-1"></a>    ax_theo.set_xlabel(<span class="st">'u'</span>)</span>
<span id="cb40-67"><a href="#cb40-67" aria-hidden="true" tabindex="-1"></a>    ax_theo.set_ylabel(<span class="st">'v'</span>)</span>
<span id="cb40-68"><a href="#cb40-68" aria-hidden="true" tabindex="-1"></a>    ax_theo.grid(<span class="va">True</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb40-69"><a href="#cb40-69" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-70"><a href="#cb40-70" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ajout d'une colorbar pour le graphique théorique</span></span>
<span id="cb40-71"><a href="#cb40-71" aria-hidden="true" tabindex="-1"></a>    fig.colorbar(cf_theo, ax<span class="op">=</span>ax_theo, orientation<span class="op">=</span><span class="st">'vertical'</span>, shrink<span class="op">=</span><span class="fl">0.9</span>)</span>
<span id="cb40-72"><a href="#cb40-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-73"><a href="#cb40-73" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb40-74"><a href="#cb40-74" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Codes_copules_files/figure-html/cell-30-output-1.png" width="1382" height="2390" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="c54892cb" class="cell" data-execution_count="30">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mpl_toolkits.mplot3d <span class="im">import</span> Axes3D</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">15</span>))</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, (name, copula) <span class="kw">in</span> <span class="bu">enumerate</span>(copulas.items(), <span class="dv">1</span>):</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calcul de la densité théorique</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fit copula to data</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> name <span class="op">==</span> <span class="st">"Student"</span>:</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>        copula.fit(rank_data.values, fix_df <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>        copula.fit(rank_data.values)</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>    pdf <span class="op">=</span> copula.pdf(grid_points).reshape(X.shape)</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Graphique 3D</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>    density_values <span class="op">=</span> empirical_kernel(np.vstack([u, v]))</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> fig.add_subplot(<span class="dv">3</span>, <span class="dv">2</span>, idx, projection<span class="op">=</span><span class="st">'3d'</span>)</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>    ax.plot_surface(X, Y, pdf, cmap<span class="op">=</span><span class="st">'viridis'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>    ax.scatter(u, v, density_values, c<span class="op">=</span><span class="st">'red'</span>, s<span class="op">=</span><span class="dv">10</span>, label<span class="op">=</span><span class="st">'Données'</span>)</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="ss">f'Densité </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss"> Copula</span><span class="ch">\n</span><span class="ss">(Surface théorique vs Points empiriques)'</span>)</span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">'u'</span>)</span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">'v'</span>)</span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>    ax.legend()</span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Codes_copules_files/figure-html/cell-31-output-1.png" width="1320" height="1434" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p><a href="../index.qmd">⬅ Retour</a></p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>